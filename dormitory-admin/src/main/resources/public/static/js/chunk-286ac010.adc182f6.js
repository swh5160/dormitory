(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-286ac010"],{"49e5":function(t,e,n){"use strict";n.d(e,"f",(function(){return c})),n.d(e,"i",(function(){return i})),n.d(e,"d",(function(){return l})),n.d(e,"h",(function(){return u})),n.d(e,"g",(function(){return s})),n.d(e,"a",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return m})),n.d(e,"b",(function(){return p})),n.d(e,"k",(function(){return b})),n.d(e,"j",(function(){return h}));var r=n("b775"),a=n("751a"),o="/api/student";function c(t){return Object(r["a"])({url:"".concat(o,"/get/page"),method:a["a"].GET,params:t})}function i(t){return Object(r["a"])({url:"".concat(o),method:a["a"].POST,data:t})}function l(t){return Object(r["a"])({url:"".concat(o,"/").concat(t),method:a["a"].DELETE})}function u(t){return Object(r["a"])({url:"".concat(o,"/").concat(t),method:a["a"].GET})}function s(){return Object(r["a"])({url:"".concat(o,"/self/info"),method:a["a"].GET})}function d(t){return Object(r["a"])({url:"".concat(o,"/apply/bed"),method:a["a"].POST,data:t})}function f(){return Object(r["a"])({url:"".concat(o,"/clock/in"),method:a["a"].POST})}function m(){return Object(r["a"])({url:"".concat(o,"/get/clock/info"),method:a["a"].GET})}function p(){return Object(r["a"])({url:"".concat(o,"/check/clock"),method:a["a"].GET})}function b(t){return Object(r["a"])({url:"".concat(o,"/update/self"),method:a["a"].PUT,data:t})}function h(t){return Object(r["a"])({url:"".concat(o,"/update/password"),method:a["a"].PUT,data:t})}},"70ad":function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return u}));var r=n("b775"),a=n("751a"),o="/api/building";function c(t){return Object(r["a"])({url:"".concat(o,"/get/page"),method:a["a"].GET,params:t})}function i(t){return Object(r["a"])({url:"".concat(o),method:a["a"].POST,data:t})}function l(t){return Object(r["a"])({url:"".concat(o,"/").concat(t),method:a["a"].DELETE})}function u(){return Object(r["a"])({url:"".concat(o,"/get/all"),method:a["a"].GET})}},ae74:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showSearch,expression:"showSearch"}],ref:"searchForm",attrs:{model:t.search,inline:!0,"label-width":"68px"}},[n("el-form-item",{attrs:{label:"房间号",prop:"rno"}},[n("el-input",{attrs:{placeholder:"请输入房间号",clearable:"",size:"mini"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.search.rno,callback:function(e){t.$set(t.search,"rno",e)},expression:"search.rno"}})],1),n("el-form-item",{attrs:{label:"楼号",prop:"bno"}},[n("el-input",{attrs:{placeholder:"请输入楼号",clearable:"",size:"mini"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.search.bno,callback:function(e){t.$set(t.search,"bno",e)},expression:"search.bno"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:t.handleQuery}},[t._v("搜索")]),n("el-button",{attrs:{icon:"el-icon-delete",size:"mini"},on:{click:t.resetQuery}},[t._v("清空")])],1)],1),n("el-row",{staticClass:"mb8",attrs:{gutter:10}},[n("el-col",{attrs:{span:1.5}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:t.rowSave}},[t._v("新增 ")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.records,height:t.tableHeight}},[n("el-table-column",{attrs:{width:"55",align:"center"}}),n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return t._l(r.roomBeds,(function(e){return n("el-form",{staticStyle:{"margin-left":"120px"}},[n("el-form-item",{attrs:{label:e.name}},[null!=e.studentId?n("el-tag",[t._v("已被占位")]):n("el-tag",{attrs:{type:"success"}},[t._v("暂无占位")]),null==e.studentId?n("el-button",{staticStyle:{"margin-left":"5px"},attrs:{icon:"el-icon-circle-plus-outline",circle:""},on:{click:function(n){return t.placeholder(e.id)}}}):t._e(),null!=e.studentId?n("el-button",{staticStyle:{"margin-left":"5px"},attrs:{icon:"el-icon-info",circle:""},on:{click:function(n){return t.lookupPlaceHolder(e.studentId)}}}):t._e(),null!=e.studentId?n("el-button",{staticStyle:{"margin-left":"5px"},attrs:{icon:"el-icon-delete-solid",circle:""},on:{click:function(n){return t.removePlaceHolder(e.id)}}}):t._e()],1)],1)}))}}])}),n("el-table-column",{attrs:{label:"楼号",align:"center",prop:"bno","show-overflow-tooltip":!0}}),n("el-table-column",{attrs:{label:"宿舍号",align:"center",prop:"rno","show-overflow-tooltip":!0}}),n("el-table-column",{attrs:{label:"楼层",align:"center",prop:"floor",width:"50"}}),n("el-table-column",{attrs:{label:"最大入住人数",align:"center",prop:"maxOccupancy",width:"150"}}),n("el-table-column",{attrs:{label:"当前入住人数",align:"center",prop:"currentOccupancy",width:"150"}}),n("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"gmtCreate",width:"200"}}),n("el-table-column",{attrs:{label:"修改时间",align:"center",prop:"gmtModified",width:"200"}}),n("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return t.rowDel(e.row)}}},[t._v("删除 ")])]}}])})],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.search.current,limit:t.search.size},on:{"update:page":function(e){return t.$set(t.search,"current",e)},"update:limit":function(e){return t.$set(t.search,"size",e)},pagination:t.getList}}),n("el-dialog",{attrs:{title:t.title,visible:t.open,width:"800px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[n("el-row",[n("el-form-item",{attrs:{label:"楼栋号",prop:"buildingId"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.buildingId,callback:function(e){t.$set(t.form,"buildingId",e)},expression:"form.buildingId"}},t._l(t.buildingDic,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:+t.value}})})),1)],1)],1),n("el-row",[n("el-form-item",{attrs:{label:"楼层",prop:"floor"}},[n("el-input-number",{attrs:{min:1,max:30,label:"楼层"},model:{value:t.form.floor,callback:function(e){t.$set(t.form,"floor",e)},expression:"form.floor"}})],1)],1),n("el-row",[n("el-form-item",{attrs:{label:"房间号",prop:"rno"}},[n("el-input",{attrs:{placeholder:"请输入宿舍号"},model:{value:t.form.rno,callback:function(e){t.$set(t.form,"rno",e)},expression:"form.rno"}})],1)],1),n("el-row",[n("el-form-item",{attrs:{label:"最大入住人数",prop:"maxOccupancy"}},[n("el-input-number",{attrs:{min:1,max:8,label:"最大入住人数"},model:{value:t.form.maxOccupancy,callback:function(e){t.$set(t.form,"maxOccupancy",e)},expression:"form.maxOccupancy"}})],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),n("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)},a=[],o=n("c7eb"),c=n("1da1"),i=(n("99af"),n("d3b7"),n("159b"),n("b0c0"),n("ac1f"),n("841c"),n("b775")),l=n("751a"),u="/api/building_room";function s(t){return Object(i["a"])({url:"".concat(u,"/get/page"),method:l["a"].GET,params:t})}function d(t){return Object(i["a"])({url:"".concat(u),method:l["a"].POST,data:t})}function f(t){return Object(i["a"])({url:"".concat(u,"/").concat(t),method:l["a"].DELETE})}function m(t){return Object(i["a"])({url:"".concat(u,"/bed/placeholder"),method:l["a"].POST,data:t})}function p(t){return Object(i["a"])({url:"".concat(u,"/bed/placeholder/clear/").concat(t),method:l["a"].DELETE})}var b=n("70ad"),h=n("49e5"),g={data:function(){return{option:{submitText:"占位",span:24,column:[{label:"学号",prop:"sno",rules:[{required:!0,message:"请输入学号",trigger:"blur"}]}]},tableHeight:window.innerHeight-340,loading:!0,single:!0,multiple:!0,showSearch:!0,total:0,records:[],title:"",open:!1,search:{current:1,size:10,rno:void 0,bno:void 0},buildingDic:[],form:{},rules:{buildingId:[{required:!0,message:"楼栋不能为空",trigger:"blur"}],rno:[{required:!0,message:"房间号不能为空",trigger:"blur"}],floor:[{required:!0,message:"楼层不能为空",trigger:"blur"}],maxOccupancy:[{required:!0,message:"最大入住人数不能为空",trigger:"blur"}]}}},created:function(){this.getList(),this.getBuildings()},methods:{lookupPlaceHolder:function(t){var e=this;Object(h["h"])(t).then((function(t){var n=t.data,r="<p>学号: ".concat(n.sno,"</p><p>学院: ").concat(n.academy,"</p><p>专业: ").concat(n.major,"</p><p>年级: ").concat(n.grade,"</p>");e.$alert(r,"学生信息",{dangerouslyUseHTMLString:!0})}))},removePlaceHolder:function(t){var e=this;this.$confirm("此操作将该学生移除该床位, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(c["a"])(Object(o["a"])().mark((function n(){return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,p(t);case 2:e.msgNoticeSuccess("移除成功"),e.getList();case 4:case"end":return n.stop()}}),n)}))))},placeholder:function(t){var e=this;this.$DialogForm.show({title:"床位占位",width:"50%",option:this.option,callback:function(){var n=Object(c["a"])(Object(o["a"])().mark((function n(r){return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,m({roomBedId:t,sno:r.data.sno});case 2:e.msgNoticeSuccess("占位成功"),e.getList(),r.done(),r.close();case 6:case"end":return n.stop()}}),n)})));function r(t){return n.apply(this,arguments)}return r}()})},getBuildings:function(){var t=this;Object(b["b"])().then((function(e){e.data.forEach((function(e){t.buildingDic.push({label:"".concat(e.name,"--\x3e").concat(e.bno),value:e.id})}))}))},getList:function(){var t=this;this.loading=!0,s(this.search).then((function(e){t.records=e.data.records,t.total=e.data.total,t.loading=!1}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={id:void 0,buildingId:void 0,rno:void 0,floor:void 0,maxOccupancy:void 0},this.resetForm("form")},handleQuery:function(){this.search.current=1,this.getList()},resetQuery:function(){this.resetForm("searchForm"),this.handleQuery()},rowSave:function(){this.reset(),this.open=!0,this.title="添加房间信息"},submitForm:function(){var t=this;this.$refs["form"].validate(function(){var e=Object(c["a"])(Object(o["a"])().mark((function e(n){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}return e.next=3,d(t.form);case 3:void 0!==t.form.id?t.msgNoticeSuccess("修改成功"):t.msgNoticeSuccess("新增成功"),t.open=!1,t.getList();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},rowDel:function(t){var e=this;this.$confirm("此操作将永久删除该信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){f(t.id).then((function(t){e.msgNoticeSuccess("删除成功"),e.getList()}))})).catch((function(){}))}}},v=g,w=n("2877"),O=Object(w["a"])(v,r,a,!1,null,"960b6368",null);e["default"]=O.exports}}]);